<h3><a class="btn btn-default" [routerLink]="['']"><i class="fa fa-chevron-left"></i> </a>
  Tablero de control</h3>
<form class="form-inline">
  <div class="form-group">
    <label>Centro de costos:</label>
    <select name="centro_costo_sel" [(ngModel)]="centro_costo" class="form-control input-sm">
      <option *ngFor="let cc of centro_costos" [ngValue]="cc">{{ cc.codigo }}</option>
    </select>
  </div>
  <div class="form-group">
    <label>Periodo:</label>
    <select name="periodo_sel" [(ngModel)]="periodo" class="form-control input-sm">
      <option *ngFor="let p of periodos" [ngValue]="p">{{ p.descripcion }}</option>
    </select>
  </div>
  <div class="form-group">
    <button class="btn btn-success btn-sm" (click)="showTablero()">Ver tablero</button>
  </div>
</form>
<hr />

<table class="table table-bordered table-condensed" *ngIf="data != undefined || data != null">
  <thead>
    <tr class="info">
      <th colspan="7" class="text-center">
        Resultado económico
        <span class="pull-right">Revisión {{ data["revision"]["version"] }} | Fecha {{ data["revision"]["fecha"]|date:"dd/MM/yyyy" }}</span>
      </th>
    </tr>
    <tr class="success">
      <th>Conceptos</th>
      <th>Acumulado</th>
      <th>Faltante estimado</th>
      <th>Faltante presupuestado</th>
      <th>Total estimado</th>
      <th>Total aprobado</th>
      <th>Total comercial</th>
    </tr>
  </thead>
  <tbody>
    <tr class="warning">
      <th>Venta</th>
      <th *ngFor="let h of headers">
        {{ data["venta"][h]["subtotal"] | number:'1.2-2' }}
      </th>
    </tr>
    <tr>
      <td>Venta contractual</td>
      <td *ngFor="let h of headers">
        {{ data["venta"][h]["venta_contractual"] | number:'1.2-2' }}
      </td>
    </tr>
    <tr>
      <td>Órdenes de cambio</td>
      <td *ngFor="let h of headers">
        {{ data["venta"][h]["ordenes_cambio"] | number:'1.2-2' }}
      </td>
    </tr>
    <tr>
      <td>Reajustes de precios</td>
      <td *ngFor="let h of headers">
        {{ data["venta"][h]["reajustes_precios"] | number:'1.2-2' }}
      </td>
    </tr>
    <tr>
      <td>Reclamos reconocidos</td>
      <td *ngFor="let h of headers">
        {{ data["venta"][h]["reclamos_reconocidos"] | number:'1.2-2' }}
      </td>
    </tr>
    <tr class="warning">
      <th>Costos</th>
      <th *ngFor="let h of headers">
        {{ data["costos"][h]["total_costos"] | number:'1.2-2' }}
      </th>
    </tr>
    <tr *ngFor="let costo_str of get_items_costos()">
      <td>{{ costo_str }}</td>
      <td *ngFor="let h of headers">
        {{ data["costos"][h][costo_str] | number:'1.2-2' }}
      </td>
    </tr>
    <tr class="warning">
      <th>Costos previstos</th>
      <th *ngFor="let h of headers">
        {{ data["costos"][h]["subtotal"] | number:'1.2-2' }}
      </th>
    </tr>
    <tr>
      <td>Contingencia</td><td></td><td></td><td></td>
      <td>{{ data["estructura_costos"]["estimado"]["contingencia"] | number:'1.2-2' }}</td>
      <td>{{ data["estructura_costos"]["presupuesto"]["contingencia"] | number:'1.2-2' }}</td>
      <td>{{ data["estructura_costos"]["comercial"]["contingencia"] | number:'1.2-2' }}</td>
    </tr>
    <tr>
      <td>Estructura asignada</td><td></td><td></td><td></td>
      <td>{{ data["estructura_costos"]["estimado"]["estructura"] | number:'1.2-2' }}</td>
      <td>{{ data["estructura_costos"]["presupuesto"]["estructura"] | number:'1.2-2' }}</td>
      <td>{{ data["estructura_costos"]["comercial"]["estructura"] | number:'1.2-2' }}</td>
    </tr>
    <tr>
      <td>Avales, garantías y seguros contractuales</td><td></td><td></td><td></td>
      <td>{{ data["estructura_costos"]["estimado"]["avales_gtia_seguros"] | number:'1.2-2' }}</td>
      <td>{{ data["estructura_costos"]["presupuesto"]["avales_gtia_seguros"] | number:'1.2-2' }}</td>
      <td>{{ data["estructura_costos"]["comercial"]["avales_gtia_seguros"] | number:'1.2-2' }}</td>
    </tr>
    <tr class="warning">
      <th>Costo industrial</th>
      <th>{{ data["costos"]['acumulado']["subtotal"] | number:'1.2-2' }}</th>
      <th>{{ data["costos"]['faltante_estimado']["subtotal"] | number:'1.2-2' }}</th>
      <th>{{ data["costos"]['faltante_presupuesto']["subtotal"] | number:'1.2-2' }}</th>
      <th>{{ data["estructura_costos"]["estimado"]["subtotal"] | number:'1.2-2' }}</th>
      <th>{{ data["estructura_costos"]["presupuesto"]["subtotal"] | number:'1.2-2' }}</th>
      <th>{{ data["estructura_costos"]["comercial"]["subtotal"] | number:'1.2-2' }}</th>
    </tr>
    <tr>
      <td rowspan="2">Impuestos y contribuciones</td>
      <td></td><td></td><td></td>
      <td>{{ data["markup"]["estimado"]["impuestos_y_contribuciones"] | number:'1.2-2' }}</td>
      <td>{{ data["markup"]["presupuesto"]["impuestos_y_contribuciones"] | number:'1.2-2' }}</td>
      <td>{{ data["markup"]["comercial"]["impuestos_y_contribuciones"] | number:'1.2-2' }}</td>
    </tr>
    <tr>
      <td></td><td></td><td></td>
      <td>{{ data["markup"]["estimado"]["impuestos_y_contribuciones_perc"] | number:'1.2-2' }}%</td>
      <td>{{ data["markup"]["presupuesto"]["impuestos_y_contribuciones_perc"] | number:'1.2-2' }}%</td>
      <td>{{ data["markup"]["comercial"]["impuestos_y_contribuciones_perc"] | number:'1.2-2' }}%</td>
    </tr>
    <tr>
      <td rowspan="2">Costo financiero e imprevistos</td>
      <td></td><td></td><td></td>
      <td>{{ data["markup"]["estimado"]["costo_financiero_e_imprevistos"] | number:'1.2-2' }}</td>
      <td>{{ data["markup"]["presupuesto"]["costo_financiero_e_imprevistos"] | number:'1.2-2' }}</td>
      <td>{{ data["markup"]["comercial"]["costo_financiero_e_imprevistos"] | number:'1.2-2' }}</td>
    </tr>
    <tr>
      <td></td><td></td><td></td>
      <td>{{ data["markup"]["estimado"]["costo_financiero_e_imprevistos_perc"] | number:'1.2-2' }}%</td>
      <td>{{ data["markup"]["presupuesto"]["costo_financiero_e_imprevistos_perc"] | number:'1.2-2' }}%</td>
      <td>{{ data["markup"]["comercial"]["costo_financiero_e_imprevistos_perc"] | number:'1.2-2' }}%</td>
    </tr>
    <tr>
      <td rowspan="2">Ganancia después de impuestos</td>
      <td></td><td></td><td></td>
      <td>{{ data["markup"]["estimado"]["ganancias_despues_impuestos"] | number:'1.2-2' }}</td>
      <td>{{ data["markup"]["presupuesto"]["ganancias_despues_impuestos"] | number:'1.2-2' }}</td>
      <td>{{ data["markup"]["comercial"]["ganancias_despues_impuestos"] | number:'1.2-2' }}</td>
    </tr>
    <tr>
      <td></td><td></td><td></td>
      <td>{{ data["markup"]["estimado"]["ganancias_despues_impuestos_perc"] | number:'1.2-2' }}%</td>
      <td>{{ data["markup"]["presupuesto"]["ganancias_despues_impuestos_perc"] | number:'1.2-2' }}%</td>
      <td>{{ data["markup"]["comercial"]["ganancias_despues_impuestos_perc"] | number:'1.2-2' }}%</td>
    </tr>
    <tr class="danger">
      <td rowspan="2">Margen Bruto</td>
      <td></td><td></td><td></td>
      <td>{{ data["markup"]["estimado"]["margen_bruto"] | number:'1.2-2' }}</td>
      <td>{{ data["markup"]["presupuesto"]["margen_bruto"] | number:'1.2-2' }}</td>
      <td>{{ data["markup"]["comercial"]["margen_bruto"] | number:'1.2-2' }}</td>
    </tr>
    <tr class="danger">
      <td></td><td></td><td></td>
      <td>{{ data["markup"]["estimado"]["margen_bruto_perc"] | number:'1.2-2' }}%</td>
      <td>{{ data["markup"]["presupuesto"]["margen_bruto_perc"] | number:'1.2-2' }}%</td>
      <td>{{ data["markup"]["comercial"]["margen_bruto_perc"] | number:'1.2-2' }}%</td>
    </tr>

  </tbody>
</table>
<div class="row" *ngIf="graph_data">
  <!--div class="col-md-12">
      <div class="panel panel-primary">
        <div class="panel-heading">
          Consolidado
        </div>
        <div class="panel-body">
          <nvd3 [options]="g_consol_options" [data]="graph_consol_data"></nvd3>
        </div>
      </div>
  </div-->
  <div class="col-md-6 col-lg-4">
    <div class="panel panel-primary">
      <div class="panel-heading">
        Certificación REAL vs PROYECTADA
      </div>
      <div class="panel-body">
        <nvd3 [options]="g_cert_options" [data]="graph_data" id="nvd3-graph-cert"></nvd3>
      </div>
    </div>
  </div>
  <div class="col-md-6 col-lg-4">
    <div class="panel panel-primary">
      <div class="panel-heading">
        Costos REALES vs PROYECTADOS
      </div>
      <div class="panel-body">
        <nvd3 [options]="g_costo_options" [data]="graph_costo_data" id="nvd3-graph-costo"></nvd3>
      </div>
    </div>
  </div>
  <div class="col-md-6 col-lg-4">
    <div class="panel panel-primary">
      <div class="panel-heading">
        Avance de obra REAL vs PROYECTADO
      </div>
      <div class="panel-body">
        <nvd3 [options]="g_avance_options" [data]="graph_avance_data" id="nvd3-graph-avance"></nvd3>
      </div>
    </div>
  </div>
</div>
